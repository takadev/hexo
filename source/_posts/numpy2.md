---
title: 行列の計算
date: 2016-12-07 00:00:00
tags:
- "NumPy"
- "python"
- "数学"
category: python
---
## 多次元配列の計算について

引き続き「ゼロから作るディープラーニング」を読んでます。
多次元配列の計算について、忘れないようにメモしておきます。
<!-- More -->

## はじめに
環境などは[こちら](http://devlog.site/python/numpy/)を参考にして下さい。
浅〜いメモなので悪しからず。

## NumPyで多次元配列を扱う

NumPyで多次元の配列について諸々試してみました。
まずは1次元配列から

```
In [1]: import numpy as np
In [2]: A = np.array([1,2,3,4])
In [3]: print(A)
[1 2 3 4]
In [4]: np.ndim(A)
Out[4]: 1
In [5]: A.shape
Out[5]: (4,)
In [6]: A.shape[0]
Out[6]: 4
```

`np.ndim()`関数で対象の配列が何次元の配列かがわかります。
`A.shape`で配列の形状が取得できます。戻り値はどうやらタプルで返ってくるようですね。
`A.shape[0]`とインデックスを指定してあげると対象の次元の形状が取得できるんですね。

次に2次元配列です。

```
In [1]: import numpy as np
In [2]: B = np.array([[1,2],[3,4],[5,6]])
In [3]: print(B)
[[1 2]
 [3 4]
 [5 6]]
In [4]: np.ndim(B)
Out[4]: 2
In [5]: B.shape
Out[5]: (3, 2)
```

**np.ndim()**が**2**を返していますね。それと**B.shape**が**(3,2)**になっています。
これで3x2の配列であることがわかりますね。
3x2の配列とは一つ目の次元に3つ要素があり次の次元に2つの要素があるってことですね。
上の式の`B = np.array([[1,2],[3,4],[5,6]])`をわかりやすく書くと

```
B = [X, Y, Z]
X = [1, 2]
Y = [3, 4]
Z = [5, 6]
```

こんな感じになります。まずBは3つの要素(X, Y, Z)を持っていて、X、Y、Zが
[1, 2]、[3, 4]、 [5, 6]の2つの要素が入った配列になっていますので3x2の配列になるんですね。

またこんな風にも表すことができます。

$$
\begin{bmatrix}
1 & 2 \\\
3 & 4 \\\
5 & 6 
\end{bmatrix}
$$

このように表記した場合の横方向の並びを行、縦方向の並びを列を呼びます。
ここでは1、2が1つの行、1、3、5が1つの列といった具合です。

## 行列の内積
次に行列の内積についてです。
行列の内積の定義は
```
a・b = |a||b|cosθ
```

で定義されます。θは2つのベクトルの始点をそろえたときにできる「なす角」のことです。
内積には幾何的な意味と代数的な意味の二つの定義があり、どちらかというと物理の分野で広く聞く言葉ですね。

定義を見てもさっぱりだと思うので簡単に言うと「ベクトルaの長さ」と、「ベクトルbをベクトルa上に射影したものの長さ」の積で求められるものということですね。
イメージするのが難しいと思うので具体的な計算方法を見てみましょう。
Pythonで行列の内積を計算する実装です。

```
In [1]: import numpy as np
In [2]: A = np.array([[1,2],[3,4]])
In [3]: B = np.array([[5,6],[7,8]])
In [4]: np.dot(A, B)
Out[4]: 
array([[19, 22],
       [43, 50]])
```

ここでは

$$
\begin{bmatrix}
1 & 2 \\\
3 & 4 
\end{bmatrix}
$$

と

$$
\begin{bmatrix}
5 & 6 \\\
7 & 8 
\end{bmatrix}
$$

という二つの行列の内積の計算を行っています。
内積の計算には**np.dot()**関数を使用します。

行列の内積の計算は左側の行列の行と右側の配列の列をそれぞれの要素の積とその和で求めることができます。
例えば1行目の1列目は**1 \* 5 + 2 \* 7**で答えが**19**となります。

計算自体は簡単ですね。内積は概念がまだまだ理解できていないので今後も詳しく調べていきたいです。
ということで終わり。

